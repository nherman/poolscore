{% extends "master.html" %}
{% set body_class = "tourney-context" %}

{% block script %}
    {% autoescape false %}
    <script>
        var gamesJSON = {{g.gamesJSON}};
        function matchModel() {
            var self = this,
                games = ko.observableArray(gamesJSON);


        {% if g.games %}
            {% for game in g.games %}
            


            {% endfor %}
        {% endif %}

        }


        function addInningEventHandler() {
            console.log(arguments);
        }

        $(function() {
//            $(".btn-add-inning").click(addInningEventHandler);
            ko.applyBindings(new matchModel());
        });
            

    </script>
    {% endautoescape %}
{% endblock %}

{% block body %}

    {% include 'tourney_header.html' %}
    <h2>Match #{{ g.match.ordinal }}</h2>
    <div class="opponents">
        <div class="row">
            <div class="col-xs-5">
                <h4>HOME<br>
                <small>{{ g.home_players[0].firstname}} {{ g.home_players[0].lastname}} ({{ g.home_players[0].handicap }})</small>
                </h4>
            </div>
            <div class="col-xs-1">
                <h4>{{ g.match.home_games }}</h4>
            </div>
            <div class="col-xs-5">
                <h4>AWAY<br>
                <small>{{ g.away_players[0].firstname}} {{ g.away_players[0].lastname}} ({{ g.away_players[0].handicap }})</small>
                </h4>
            </div>
            <div class="col-xs-1">
                <h4>{{ g.match.away_games }}</h4>
            </div>
        </div>
    </div>

    <div class="games">
        <form data-bind="foreach: {data: games, as: 'game'}">
            <span data-bind="text: game"></span>

<!--
            <div class="panel {% if game.in_progress %}panel-primary{% else %}panel-default{% endif %}">
                <div class="panel-heading">
                    <h3 class="panel-title">Game {{ game.ordinal }}</h3>
                    {% if game.in_progress %}<div class="in-progress">IN PROGRESS</div>{% endif %}
                </div>
                <div class="panel-body">
                <button type="button" class="btn-add-inning" value="add_inning_{{ game.id }}">Add Inning</button>
                </div>
            </div>
-->
        </form>
    </div>

    <form action="{{ url_for('match', mid=g.match.id) }}" method="post" role="form">
        <div class="row">
            <div class="col-xs-6 text-center">
                <button type="submit" class="btn-new-game" name="new_match" value="start_game">Start New Game</button>
            </div>
            <div class="col-xs-6 text-center">
                <button type="submit" class="btn-end-match" name="end_tourney" value="end_match">End Match</button>
            </div>
        </div>
    </form>

{% endblock %}

